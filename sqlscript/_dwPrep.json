{
	"name": "_dwPrep",
	"properties": {
		"folder": {
			"name": "VirtualDW"
		},
		"content": {
			"query": "use fno\ngo\n\ncreate schema dw\ngo\n\ncreate external file format ParquetFileFormat with\n  ( format_type = PARQUET,\n    data_compression = 'org.apache.hadoop.io.compress.SnappyCodec' )\ngo\n\ncreate external data source ParquetDataSource\n  with (location = N'https://techdeliverydatalake.dfs.core.windows.net/parquet/'\n       ,credential = [dynamics365_financeandoperations_d365techdelivery_dev_sandbox])\ngo\n\ncreate or alter view raw.vwDimCostCenter as \n  select t1.RecId as [Key]\n        ,t1.OMOperatingUnitNumber as CC\n        ,t1.Name as CostCenter \n    from raw.DirPartyTable t1 \n   where t1.OMOperatingUnitType = 2 \n     and t1.InstanceRelationType = 8363\ngo\n\ncreate or alter view raw.vwDimBusinessUnit as \n  select t1.RecId as [Key]\n        ,t1.OMOperatingUnitNumber as BU\n        ,t1.Name as BusinessUnit \n    from raw.DirPartyTable t1 \n   where t1.OMOperatingUnitType = 4 \n     and t1.InstanceRelationType = 8363\ngo\n\ncreate or alter view raw.vwDimDepartment as \n  select t1.RecId as [Key]\n        ,t1.OMOperatingUnitNumber as Dept\n        ,t1.Name as Department \n    from raw.DirPartyTable t1 \n   where t1.OMOperatingUnitType = 1 \n     and t1.InstanceRelationType = 8363\ngo\n\ncreate or alter view raw.vwDimLegalEntity as \n  select l.RecId as [Key]\n        ,upper(dpt.DataArea) as DataAreaId\n        ,dpt.Name as CompanyName   \n    from raw.Ledger l\n         inner join raw.DirPartyTable dpt on l.PrimaryForLegalEntity = dpt.RecId\ngo\n\ncreate or alter view raw.vwDimMainAccount as \n  select m.RecId as [Key]\n\t      ,m.MainAccountId as MainAccount\n\t      ,m.Name\n\t      ,l.Name as ChartOfAccountName\n    from raw.MainAccount m\n         inner join raw.LedgerChartOfAccounts l on l.RecId = m.LedgerChartOfAccounts\ngo\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "fno",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}